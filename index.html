<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>HUB-UNO ‚Äî Mono PWA + Alias</title>
<meta name="theme-color" content="#0b0f14"/>
<link rel="manifest" href="./manifest.webmanifest"/>
<link rel="icon" href="./icons/icon-192.png" sizes="192x192"/>
<link rel="apple-touch-icon" href="./icons/icon-192.png"/>
<style>
:root{
  --grad-a:#ff52e5; --grad-b:#00c5e5;
  --fg:#eaf2ff; --mut:rgba(234,242,255,.68);
  --surface:rgba(15,17,32,.60); --bd:1px solid rgba(255,255,255,.12);
  --tabsH:70px; --hdrH:64px; --shadow:0 14px 40px rgba(0,0,0,.45);
  --arch-overlay: rgba(64,158,255,.22);
}
body[data-theme="blue1"]{ --grad-a:#0044ff; --grad-b:#00aaff; --fg:#e6f2ff; --mut:rgba(230,242,255,.72); --surface:rgba(10,16,28,.62); --bd:1px solid rgba(126,170,255,.18);}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;color:var(--fg);font:14px/1.45 Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  -webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;overflow:hidden;position:relative;
  background:
    radial-gradient(120% 120% at 50% 40%, var(--arch-overlay, rgba(0,0,0,0)) 0%, rgba(0,0,0,0) 62%),
    linear-gradient(42deg, var(--grad-a), var(--grad-b)) fixed;
}
header.mast{position:fixed;left:0;right:0;top:0;height:var(--hdrH);z-index:100;
  display:flex;align-items:center;gap:10px;padding:0 12px;
  backdrop-filter:blur(18px) saturate(130%);
  background:linear-gradient(180deg,rgba(0,0,0,.28),rgba(0,0,0,0))}
.ib{width:42px;height:42px;border-radius:50%;display:grid;place-items:center;background:var(--surface);border:var(--bd);cursor:pointer;box-shadow:var(--shadow)}
.title{flex:1;text-align:center;line-height:1}
.title h1{margin:0;font-size:18px;letter-spacing:.06em;font-weight:900}
.title small{display:block;color:var(--mut);letter-spacing:.1em}
main{position:relative;height:100%;padding-top:calc(var(--hdrH) + env(safe-area-inset-top));padding-bottom:calc(var(--tabsH) + env(safe-area-inset-bottom));overflow:hidden}
.view{position:absolute;inset:0;padding:12px 14px;overflow:auto;display:none}
.view.active{display:block;animation:fade .35s ease}
@keyframes fade{from{opacity:0;transform:scale(.995)}to{opacity:1;transform:scale(1)}}
.grid{display:grid;gap:12px;max-width:860px;margin:0 auto}
.card{background:var(--surface);border:var(--bd);border-radius:16px;box-shadow:var(--shadow);padding:12px}
.btn{background:linear-gradient(180deg,#11162a,#0b1122);color:var(--fg);border:var(--bd);padding:.58rem .9rem;border-radius:12px;font-weight:800;cursor:pointer}

/* orb */
.arch-container{display:flex;flex-direction:column;align-items:center;gap:10px;margin-top:5vh}
.arch-switcher{display:flex;gap:6px;align-items:center;background:rgba(15,17,32,.7);border:var(--bd);border-radius:999px;padding:4px 8px;backdrop-filter:blur(8px);z-index:70}
.arch-switcher select{appearance:none;background:rgba(255,255,255,.06);color:var(--fg);border:1px solid rgba(255,255,255,.12);border-radius:999px;padding:4px 8px;font-size:12px}
.arch-circle{position:relative;width:min(82vw,560px);aspect-ratio:1;border-radius:50%;overflow:hidden;border:1px solid rgba(255,255,255,.12);background:radial-gradient(60% 60% at 50% 50%,rgba(0,255,255,.08),rgba(255,255,255,.02));box-shadow:var(--shadow)}
.arch-circle .orb-wrap{position:absolute;inset:6%;width:88%;height:88%;border-radius:50%;display:grid;place-items:center;pointer-events:none}
.arch-circle canvas#orb, .arch-circle canvas#dust{position:absolute;inset:0;width:100%;height:100%;border-radius:50%;display:block;pointer-events:none;mix-blend-mode:screen}
.arch-circle .orb-glow{position:absolute;inset:-8%;border-radius:50%;background:radial-gradient(60% 60% at 50% 50%,rgba(122,60,255,.18),rgba(0,229,255,.14) 45%,transparent 70%);filter:blur(16px);opacity:.92}
#arch-fadeCover{position:absolute;inset:0;background:var(--arch-overlay, transparent);opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:3}
#arch-fadeCover.show{opacity:1}
.orb-slot{position:absolute;inset:8%;border-radius:50%;overflow:hidden;z-index:2;mix-blend-mode:normal}
.orb-slot iframe{position:absolute;inset:0;width:100%;height:100%;border:0;background:#0b0f14}
.arch-msg{margin-top:8px;padding:6px 10px;border-radius:12px;background:rgba(15,17,32,.72);color:var(--fg);font-size:13px;max-width:90%;text-align:center;opacity:0;transition:opacity .3s ease}
.arch-msg.show{opacity:1}

/* chat */
.chat-wrap{display:grid;gap:12px}
.chat-pulse{position:relative;height:10px;border-radius:999px;background:linear-gradient(90deg,var(--grad-a),var(--grad-b));opacity:.8;overflow:hidden}
.chat-pulse::after{content:"";position:absolute;inset:0;background:radial-gradient(60% 120% at 0% 50%, #fff8 0%, #fff0 60%);animation:pulseRun 2.8s cubic-bezier(.22,.61,.36,1) infinite}
@keyframes pulseRun{0%{transform:translateX(-40%)}50%{transform:translateX(40%)}100%{transform:translateX(140%)}}
.chat-feed{display:grid;gap:10px}
.msg{background:var(--surface);border:var(--bd);border-radius:14px;padding:10px}
.msg.role-user{border-color:#ffffff2a}
.msg.role-assistant{box-shadow:0 10px 32px rgba(0,0,0,.35)}
.msg h5{margin:.2rem 0 .35rem;font-size:12px;letter-spacing:.08em;color:var(--mut);text-transform:uppercase}
.chat-composer{display:flex;gap:8px;align-items:center;position:sticky;bottom:0;background:linear-gradient(180deg,rgba(0,0,0,0),rgba(0,0,0,.2));padding:10px;border-radius:16px}
.chat-composer textarea{flex:1;min-height:44px;max-height:36vh;resize:vertical;border-radius:12px;padding:10px 12px;border:var(--bd);background:rgba(255,255,255,.04);color:var(--fg)}
.chat-composer .btn{white-space:nowrap}
</style>
</head>
<body>
<header class="mast">
  <button class="ib" id="btnTheme" title="Tema">üí†</button>
  <div class="title"><h1>HUB-UNO ‚Äî Mono PWA + Alias</h1><small>N√©bula ‚Üî BlueTrace</small></div>
  <button class="ib" id="aliasPanelBtn" title="Loader Panel">üß©</button>
  <button class="ib" id="btnSettings" title="Configura√ß√µes">‚öôÔ∏è</button>
</header>

<main>
  <section id="v-home" class="view active">
    <div class="grid">
      <div class="arch-container">
        <div class="arch-switcher">
          <select id="arch-select" title="Arqu√©tipo">
            <option>atlas</option><option>nova</option><option>vitalis</option><option>pulse</option>
            <option>artemis</option><option>serena</option><option>kaos</option><option>genus</option>
            <option>lumine</option><option>rhea</option><option>solus</option><option>aion</option>
          </select>
        </div>
        <div class="arch-circle">
          <div class="orb-wrap" aria-hidden="true"><canvas id="orb"></canvas><div class="orb-glow"></div><canvas id="dust"></canvas></div>
          <div id="arch-fadeCover"></div>
          <div class="orb-slot"><iframe id="arch-frame" sandbox="allow-scripts" referrerpolicy="no-referrer" src="./archetypes/atlas.html"></iframe></div>
        </div>
        <div id="archMsg" class="arch-msg">Pronto.</div>
      </div>
    </div>
  </section>

  <section id="v-apps" class="view">
    <div class="grid"><div class="card">Apps‚Ä¶</div></div>
  </section>

  <section id="v-chat" class="view">
    <div class="grid">
      <div class="card"><div style="font-weight:800;margin-bottom:6px">Pulso em Expans√£o</div><div class="chat-pulse" id="chatPulse"></div></div>
      <div class="card">
        <div class="chat-wrap">
          <div id="chatFeed" class="chat-feed" aria-live="polite"></div>
          <div class="chat-composer">
            <textarea id="chatInput" placeholder="Escreva sua inten√ß√£o... (Shift+Enter quebra linha)"></textarea>
            <button id="chatSend" class="btn">Enviar</button>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<nav class="tabbar">
  <div class="inner">
    <button class="tab active" data-nav="home">üè†<span class="small">Home</span></button>
    <button class="tab" data-nav="apps">üóÇÔ∏è<span class="small">Apps</span></button>
    <button class="tab" data-nav="chat">üí¨<span class="small">Chat</span></button>
  </div>
</nav>

<script>
// Minimal dynamic loader: bundle | groups | modules
(function(){
  const MODE = localStorage.getItem('uno:loader:mode') || 'all';
  const MODS = (()=>{ try{return JSON.parse(localStorage.getItem('uno:modules:enabled')||'{}')}catch{return{}} })();
  function load(src){ return new Promise((res,rej)=>{ const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=()=>rej(new Error('fail '+src)); document.body.appendChild(s); }); }
  async function boot(){
    try{
      if(MODE==='all'){
        await load('./scripts/all.bundle.js');
      }else if(MODE==='groups'){
        await load('./scripts/groups/core.group.js');
        await load('./scripts/groups/ui.group.js');
        await load('./scripts/groups/ai.group.js');
      }else{ // modules
        const list=['core','overlay','panel','settings.panel','orb','apps','chat13','sw-register'];
        const enabled = Object.keys(MODS).length ? list.filter(k=>MODS[k]) : list;
        for(const m of enabled){ await load('./scripts/modules/'+m+'.js'); }
      }
    }catch(e){
      console.error('loader error', e);
      const err = document.createElement('div'); err.className='card'; err.innerHTML = `<div class="mut">Loader: ${e.message}</div>`;
      document.querySelector('.grid')?.appendChild(err);
    }
  }
  boot();
})();

// SW register for PWA offline/install
if('serviceWorker' in navigator){ window.addEventListener('load',()=>navigator.serviceWorker.register('./sw.js')); }
</script>
</body>
</html>